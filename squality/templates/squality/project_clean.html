{% extends 'squality/base/layout.html' %}

{% load static %}

{% block main %}

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">{{ project.name }}</h1>
</div>

<div class="container">
  <a href="{% url 'index' %}" class="btn btn-info"><i class="bi-house"></i></a>
  <a href="{% url 'project_details' project.id %}" class="btn btn-secondary">Back: Import Data</a>
  <h2 class="col mt-2">Data Cleaning</h2>

  <form action="{% url 'clean_rename' project.id 'sdmetric' %}" method="post" autocomplete="off">
    {% csrf_token %}
    <div class="input-group mb-3">
      
        <input type="text" class="form-control" placeholder="Part's of class name to remove" name="str_sdmetric" required>
        <button class="btn btn-outline-secondary" type="submit">Remove String</button>
      
    </div>
  </form>
    
    <div class="card mt-3 mb-3">
        <h5 class="card-header">SDMetrics: Available Classes</h5>
        <div class="card-body">
            
            <table class="table table-striped table-hover table-sm">
                <thead>
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">Class Name</th>
                    <th scope="col">CBO</th>
                    <th scope="col">IC</th>
                    <th scope="col">OC</th>
                    <th scope="col">CAM</th>
                    <th scope="col">NCO</th>
                    <th scope="col">DIT</th>
                    <th scope="col">RFC</th>
                    <th scope="col">LOC</th>
                    <th scope="col">NCA</th>
                    <th scope="col">&nbsp;</th>
                  </tr>
                </thead>
                <tbody>
                  {% for sd in sdmetrics %}
                  <tr>
                    <td>{{ forloop.counter }}.</td>
                    <td>{{ sd.class_name }}</td>
                    <td>{{ sd.cbo }}</td>
                    <td>{{ sd.ic }}</td>
                    <td>{{ sd.oc }}</td>
                    <td>{{ sd.cam }}</td>
                    <td>{{ sd.nco }}</td>
                    <td>{{ sd.dit }}</td>
                    <td>{{ sd.rfc }}</td>
                    <td>{{ sd.loc }}</td>
                    <td>{{ sd.nca }}</td>
                    <td>
                      <form action="{% url 'clean_delete' sd.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-outline-secondary btn-sm"><i class="bi-trash-fill"></i></a></button>
                      </form>
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
    
        </div>
    </div>

    <hr>

    <form action="{% url 'clean_rename' project.id 'cloc' %}" method="post" autocomplete="off">
      {% csrf_token %}
      <div class="input-group mb-3">
        
          <input type="text" class="form-control" placeholder="Part's of class name to remove" name="str_cloc" required>
          <button class="btn btn-outline-secondary" type="submit">Remove String</button>
        
      </div>
    </form>

    <form action="{% url 'clean_syn_cloc' project.id %}" method="post">
      {% csrf_token %}
      <button class="btn btn-danger btn-sm" type="submit">Sync with SDMetrics Classes</button>
    </form>
      
      <div class="card mt-3 mb-3">
          <h5 class="card-header">CLOC: Available Classes</h5>
          <div class="card-body">
              
              <table class="table table-striped table-hover table-sm">
                  <thead>
                    <tr>
                      <th scope="col">#</th>
                      <th scope="col">Class Name</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for cloc in clocs %}
                    <tr>
                      <td>{{ forloop.counter }}.</td>
                      <td>{{ cloc.class_name }}</td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
      
          </div>
      </div>

    <hr>

    <form action="{% url 'clean_rename' project.id 's101' %}" method="post" autocomplete="off">
      {% csrf_token %}
      <div class="input-group mb-3">
        
          <input type="text" class="form-control" placeholder="Part's of class name to remove" name="str_s101" required>
          <button class="btn btn-outline-secondary" type="submit">Remove String</button>
        
      </div>
    </form>

    <div class="row">
      <div class="col-4">
        <form action="{% url 'clean_syn_s101' project.id %}" method="post">
          {% csrf_token %}
          <button class="btn btn-danger btn-sm" type="submit">Sync with SDMetrics Classes</button>
        </form>
      </div>
      {% for u in s101_usages %}
      <div class="col">
        <form action="{% url 'clean_remove_usage' project.id u.usage %}" method="post">
          {% csrf_token %}
          <button class="btn btn-sm btn-warning">
            <i class="bi-x-octagon"></i> {{ u.usage}}
          </button>
        </form>
      </div>
      {% endfor %}
    </div>

    <div class="card mt-3 mb-3">
      <h5 class="card-header">Structure101: Available Classes</h5>
      <div class="card-body">
        <div class="row">
          <div class="col">
            <table class="table table-striped table-hover table-sm">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Class Name (From)</th>
                </tr>
              </thead>
              <tbody>
                {% for s in s101s_from %}
                <tr>
                  <td>{{ forloop.counter }}.</td>
                  <td>{{ s.class_from }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          <div class="col">
            <table class="table table-striped table-hover table-sm">
              <thead>
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Class Name (To)</th>
                </tr>
              </thead>
              <tbody>
                {% for st in s101s_to %}
                <tr>
                  <td>{{ forloop.counter }}.</td>
                  <td>{{ st.class_to }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
        </div>
    </div>

    <div class="row pt-2 pb-5">
      <a href="{% url 'raw_migration' project.id %}" class="btn btn-secondary">Next: Metric Clustering</a>
    </div>
      

</div>

  

{% endblock %}